[
["index.html", "R for Data Science - Solutions Welcome", " R for Data Science - Solutions Alessio Benedetti 2019-11-09 Welcome This book contains the solutions to the exercises of Garret’s and Hadley’s book: R for Data Science. Rather than using the classical studying paradigm, I’ve decided to give a try to a shared way via a github project. To present all the stuff in a neat and easy way I chose Yihui’s bookdown. This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License. These solutions are the result of my own work. You can support the project on github by opening issues or submitting a pull request. On the book’s cover(1) you’ll find a funny little critter called wombat. Unlike the kākāpō, the common wombat is not critically endangered but the northern hairy-nosed wombat is, so, If you’d like to help, you may consider giving a donation to the IUCN Red List of Threatened Species. (1) The book’s cover was made with the O RLY Cover Generator web app by Charles Berlin. (2) Photo by Pascal Renet from Pexels. "],
["chapter-1-data-visualization-with-ggplot2.html", "Chapter 1. Data visualization with ggplot2 First Steps Aesthetic Mappings Facets", " Chapter 1. Data visualization with ggplot2 R4DS’s github reference: r4ds/visualize.Rmd First Steps As a prerequisite install the tidyverse package. if (!require(&quot;tidyverse&quot;)) install.packages(&quot;tidyverse&quot;) library(tidyverse) Question 1: Run ggplot(data = mpg). What do you see? ggplot(data = mpg) Running the previous statement displays an empty plot. It only creates a coordinates system that can host additional layers, but unless no layer is added, nothing is displayed. Question 2: How many rows are in mpg? How many columns? str(mpg) ## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 234 obs. of 11 variables: ## $ manufacturer: chr &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ... ## $ model : chr &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ... ## $ displ : num 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ... ## $ year : int 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ... ## $ cyl : int 4 4 4 4 6 6 6 4 4 4 ... ## $ trans : chr &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ... ## $ drv : chr &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ... ## $ cty : int 18 21 20 21 16 18 18 18 16 20 ... ## $ hwy : int 29 29 31 30 26 26 27 26 25 28 ... ## $ fl : chr &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ... ## $ class : chr &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ... There are 234 rows and 11 columns. The structure statement (str) summarizes the observations (rows) and variables (columns). Question 3: What does the drv variable describe? Read the help for ?mpg to find out. mpg$drv is a categorical variable that indicates the wheel type. It has three possible values: #f = front-wheel drive r = rear wheel drive 4 = 4wd This information is retrievable with the ?mpg statement in the console or the “Help” tab in R Studio. Question 4: Make a scatterplot of hwy vs cyl. ggplot(data = mpg) + geom_point(mapping = aes(x = cyl, y = hwy)) In the previous statement we added the geom_point portion to define a scatterplot layer. Question 5: What happens if you make a scatterplot of class vs drv? Why is the plot not useful? ggplot(data = mpg) + geom_point(mapping = aes(x = class, y = drv)) Even if we’re able to plot drv against class, the resulting graph is not very useful since we’re dealing with two categorical variables. It simply output the different combinations of the two features. Aesthetic Mappings Question 1: What’s gone wrong with this code? Why are the points not blue? ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = &quot;blue&quot;)) To manually set the color of an aesthetic, the color would be an argument of the geom function and therefore should goes outside the aes(). Here’s the correct code: ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;) Question 2: Which variables in mpg are categorical? Which variables are continuous? (Hint: type ?mpg to read the documentation for the dataset). How can you see this information when you run mpg? In general categorical variables represent types of data which may be divided into finite number of groups while continuous variables have an infinite number of values between any two values. However much depends on the nature of the analysis: have a look at the following post, where people is debating around year variable. For a nice recap you can take a look at Niklas article. For the purpose of our analysis we should consider how R treats the data we provide. By using the structure statement or or if you’ve loaded the tidyverse package simply type mpg, we can take a look at the mpg dataset: str(mpg) ## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 234 obs. of 11 variables: ## $ manufacturer: chr &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ... ## $ model : chr &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ... ## $ displ : num 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ... ## $ year : int 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ... ## $ cyl : int 4 4 4 4 6 6 6 4 4 4 ... ## $ trans : chr &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ... ## $ drv : chr &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ... ## $ cty : int 18 21 20 21 16 18 18 18 16 20 ... ## $ hwy : int 29 29 31 30 26 26 27 26 25 28 ... ## $ fl : chr &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ... ## $ class : chr &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ... mpg ## # A tibble: 234 x 11 ## manufacturer model displ year cyl trans drv cty hwy fl class ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; ## 1 audi a4 1.8 1999 4 auto~ f 18 29 p comp~ ## 2 audi a4 1.8 1999 4 manu~ f 21 29 p comp~ ## 3 audi a4 2 2008 4 manu~ f 20 31 p comp~ ## 4 audi a4 2 2008 4 auto~ f 21 30 p comp~ ## 5 audi a4 2.8 1999 6 auto~ f 16 26 p comp~ ## 6 audi a4 2.8 1999 6 manu~ f 18 26 p comp~ ## 7 audi a4 3.1 2008 6 auto~ f 18 27 p comp~ ## 8 audi a4 q~ 1.8 1999 4 manu~ 4 18 26 p comp~ ## 9 audi a4 q~ 1.8 1999 4 auto~ 4 16 25 p comp~ ## 10 audi a4 q~ 2 2008 4 manu~ 4 20 28 p comp~ ## # ... with 224 more rows R classifies variable as: categorical if labeled as chr continuous if labeled as num, int (or dbl) So for the mpg dataset we may establish the following classification: Variable Type manufacturer categorical model categorical displ continuous year continuous cyl continuous trans categorical drv categorical cty continuous hwy continuous fl categorical class categorical As said before certain variables might have been classified as categorical instead as continuous (eg: year or cyl). This can be managed by using certains functions (as.factor() for instance). Question 3: Map a continuous variable to color, size, and shape. How do these aesthetics behave differently for categorical vs. continuous variables? If we map cyl we can create the following plots: ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = cyl)) ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, size = cyl)) #ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, shape = cyl)) #Error: A continuous variable can not be mapped to shape When mapping continuous variables, ggplot2 produces a scale that varies in color (first plot), size (second plot) or an error for the shape (third plot). Mapping continuous variables in fact does not gave valuable information. As said before a variable misclassified as continuous might be managed with the as.factor() function as shown below: ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = as.factor(cyl))) Question 4: What happens if you map the same variable to multiple aesthetics? Let’s come back to the categorical variable drv. If we map it to the three aesthetics color, size, shape, the resulting plot is a combination of the three in the same graph. ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = drv, size = drv, shape = drv)) ## Warning: Using size for a discrete variable is not advised. Question 5: What does the stroke aesthetic do? What shapes does it work with? (Hint: use ?geom_point) The stroke aesthetic let you modify the width of the border, for shapes that have a border (shapes code from 21 to 25). ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy), shape = 25, stroke = 2, fill = &#39;green&#39;) Question 6: What happens if you map an aesthetic to something other than a variable name, like aes(colour = displ &lt; 5)? Note, you’ll also need to specify x and y. Let’s take an example: ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = displ &lt; 5)) Once you specify a condition, a boolean condition, ggplot2 evaluates the condition and produces a plot accordingly. Facets Question 1: What happens if you facet on a continuous variable? Let’s use a new continuous variable as argument of the facet_wrap option (for instance cty/hwy), and plot the data for the first 5 observations. We obtain: ggplot(data = head(mpg,5)) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_wrap(~ cty/hwy, nrow = 2) In using a continuous variable, for each distinct value a facet is created and since the variable is continuous we create an unuseful number of subplots. Question 2: What do the empty cells in plot with facet_grid(drv ~ cyl) mean? How do they relate to this plot? Let’s show the empty cells in the plot: ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(drv ~ cyl) These empty cells mean that there are no observations for that combination of facet’s variables. This can be checked with the following statements: subset(mpg, drv == \"5\" &amp; cyl == \"4\") subset(mpg, drv == \"f\" &amp; cyl == \"8\") Since those observations are not within the dataframe they’re not plotted. Question 3: What plots does the following code make? What does . do? ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(drv ~ .) ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(. ~ cyl) Those chunks in fact plot the very same graph as those below, they’re are simply transposed. Think the facets as rows and columns of a matrix. The first chunks represent a matrix with 3 rows and 1 column while the second 1 row x 3 columns. You may notice that they’ve been scaled for sake of representation but in fact they display the same information. ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_wrap(~ drv) ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_wrap(~ cyl) Unlike facet_wrap, facet_grid need two arguments, but thanks to the . character you can use one variable by “filling” the second required argument. Question 4: Take the first faceted plot in this section (plots below). What are the advantages to using faceting instead of the colour aesthetic? What are the disadvantages? How might the balance change if you had a larger dataset? ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_wrap(~ class, nrow = 2) Using faceting let you “isolate” a particular variable, and represent its respective datapoints. Datapoints that falls in several buckets can be distinguished. For example this combination subset(mpg, displ == 4.7 &amp; hwy == 12), is represented in the color aesthetic as suv class. With faceting you’re able to see that beside suv, at least one datapoint in the pickup class has such values. The disadvantage of faceting happens when the variable’s factor values increases. It becomes dificult to visually compare an excessive amount of plots. In that case a representation with the color aesthetic would be beneficial. ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy, color = class)) Question 5: Read ?facet_wrap. What does nrow do? What does ncol do? What other options control the layout of the individual panels? Why doesn’t facet_grid() have nrow and ncol arguments? ncol e nrow let you specify the number of columns/rows you wish to use to organise the layout of the facets subplots. Another options controls available is scales: it let you “uncouple” the scales of each facet from the overall layout scale (all, only x axis or only y axis). face_grid implicitly require a couple of variables in the formula, the nrow and ncol values are implicitly retrieved from the distinct values of the variables. Question 6: When using facet_grid() you should usually put the variable with more unique levels in the columns. Why? Usually monitors hare larger than taller. Using the variable with more unique levels in the colum let you display plots with fewer rows than columns, resulting in an improved readability. Take a look a the following plot with the trans variable (10 distinct values) and drv (3 distinct values). ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(drv ~ trans) ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy)) + facet_grid(trans ~ drv) The first is more readable. "]
]
